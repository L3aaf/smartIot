### 一、项目目标

设计并实现一个基于 STM32F103C8T6 单片机的智能家居系统，该系统能够连续监测环境温度并通过无线模块与移动设备通信，实现温度数据的实时远程监控，并且实现家电的远程控制。

### 二、概要实现方案

1. 通过 STM32F103C8T6 控制各个外设通道的使用，获取每个传感器传来的数据或控制传感器，显示在 0.96 寸 OLED 屏幕。
2. 使用 Arduino IDE 编写 ESP-01S(ESP8266) 的 SDK，实现硬件设备对 MQTT 服务器的设备数据上行和对下发命令的接受。
3. 使用 HBuilderX 编写 MQTT 服务器的连接、订阅、发送消息等操作的上位机安卓应用，实现 MQTT 服务器数据到上位机的显示和对硬件控制的数据下发，最终实现软硬件设备互联。

### 三、系统组成

#### 3.1 传感器节点

**硬件组成**
- 核心控制单元：STM32F103C8T6 单片机。
- 温度传感器：如 DHT11、DS18B20 或其他数字/模拟传感器。
- 显示单元：0.96 OLED(SSD1315)，用于本地显示温度读数。
- 无线通信模块：Wi-Fi 模块 ESP-01S，用于数据传输。

#### 3.2 控制节点

**硬件组成**
- 核心控制单元：STM32F103C8T6 单片机。
- 继电器：单路光耦继电器模拟控制开关。
- 无线通信模块：Wi-Fi 模块 ESP-01S，用于命令下发。

#### 3.3 WIFI网关

**硬件组成**
- 核心控制单元：ESP-01S，直接作为核心 MCU 编写程序以接收和上行数据给 MQTT 服务器。

#### 3.4 软件环境

- 操作系统：Windows
- MDK：Keil uVision5
- IDE：Visual Studio Code、Arduino IDE
- 前端 IDE：HBuilderX
- EDA 工具：嘉立创EDA

#### 3.5 软件组成

**固件程序**
- 运行在 STM32F103C8T6 上，负责数据采集、处理和无线传输。ESP-01S SDK，负责与网关 ESP-01S 进行数据传输，网关进行数据上行服务器和命令下发。

**APP**
- 用于接收并显示来自监测系统的温度数等下发控制命令。

#### 3.6 服务器

- 服务器类型：阿里云轻量应用型服务器
- MQTT 服务器：通过阿里云服务器搭建的 EMQX 服务器（MQTT 服务器）

### 四、功能要求

#### 4.1 传感器节点

- 温度监测：系统需每 100ms 采集一次温度数据。
- 数据显示：在 OLED 上每次采集后即时更新温度显示。
- 数据传输：无线模块需每秒至少向网关传输一次温度数据。
- 用户交互：用户可通过移动应用程序实时查看温度数据。

#### 4.2 控制节点

- 控制命令：处理网关发送过来的命令，转换成对应的控制命令，驱动完成对应的控制操作，比如控制继电器，电机，加热管，门禁等。

### 五、技术路线

#### 5.1 传感器节点

- 数据采集：编程 STM32F103C8T6 以连续从传感器获取温度数据。
- 数据处理：实施算法将传感器信号转换为温度值。
- 显示逻辑：设计界面并控制 OLED 显示读数。
- 无线通信：配置无线模块与移动设备之间的数据传输。
- 移动端应用：开发应用程序来接收、处理和显示数据。
- 测试和优化：系统测试并优化性能和稳定性。

#### 5.2 控制节点

- 命令接收：编程 ESP-01S 处理从网关传来的控制命令。
- 命令下发：通过串口传输给 STM32 来控制继电器的闭合。

### 六、性能指标

- 准确性：温度读数精确度需达到传感器规格要求。
- 稳定性：系统应连续运行且无故障。
- 响应时间：系统对环境温度变化的响应时间应小于 1 秒。
- 用户体验：应用程序界面简洁直观，易于操作。

### 七、进度安排

1. 需求分析与计划：定义系统需求，完成项目计划。
2. 硬件设计与购买：选择合适的传感器和组件，完成硬件设计。
3. 软件开发：编写单片机固件和移动应用程序。
4. 集成测试：硬件与软件集成后进行测试。
5. 软硬件互联：完成最终的系统组装。
